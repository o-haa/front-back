<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H_JOIN</title>
    <script src="https://unpkg.com/axios@0.26.0/dist/axios.min.js"></script>
</head>
<body>
    <h3>JOIN</h3>
    <form method="post" action="/" id="join_frm">
        <table>
            <tr>
                <td>ID</td>
                <td>
                    <input type="text" name="id" id="id">
                </td>
            </tr>
            <tr>
                <td>PW</td>
                <td>
                    <input type="text" name="pw" id="pw">
                </td>
            </tr>
            <tr>
                <td>NAME</td>
                <td>
                    <input type="text" name="name" id="name">
                </td>
            </tr>
            <tr>
                <td>NICKNAME</td>
                <td>
                    <input type="text" name="nickname" id="nickname">
                </td>
            </tr>
            <tr>
                <td>BIRTH</td>
                <td>
                    <input type="text" name="birth" id="birth">
                </td>
            </tr>
            <tr>
                <td>GENDER</td>
                <td>
                    <input type="radio" name="gender" value="MAN" checked><label for="gender1">MAN</label>
                    <input type="radio" name="gender" value="WOMAN"><label for="gender2">WOMAN</label>
                </td>
            </tr>
            <tr>
                <td>PHONE</td>
                <td>
                    <input type="text" name="phone" id="phone">
                </td>
            </tr>
        </table>
        <input type="submit" value="JOIN" id="btn">
    </form>
    <script type="text/javascript">
        const j_frm = document.querySelector('#join_frm')
        j_frm.addEventListener('submit', async (e)=>{
            (e).preventDefault()

            const btn = document.querySelector('#btn')
            btn.value="Loading"
            btn.disabled=true //버튼 못누르게 비활성화 만들기

            const data = {
                userid:document.querySelector('#id').value,
                userpw:document.querySelector('#pw').value,
                username:document.querySelector('#name').value,
                nickname:document.querySelector('#nickname').value,
                birth:document.querySelector('#birth').value,
                gender:document.querySelector('input[name="gender"]:checked').value,
                phone:document.querySelector('#phone').value,
            }

            const option = {
                'Content-type' : 'application/json',
                withCredentials:true, //쿠키전송.
            }

            const response = await axios.post('http://localhost:4001/api/user/join',data)
            if (response.data.errno === 0 ){
                console.log('Good')
                location.href="/"
            } else {
                alert('ERROR')
            }
            
        })



    </script>
</body>
</html>